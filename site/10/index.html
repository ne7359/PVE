
<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="PVE 虚拟化黑苹果显卡直通教程（核显&amp;amp;独显通用），低延迟远程访问方案：VNC、ARD、ToDesk、ParSec、Jump Desktop 等远程桌面协议/软件测试横评
"><meta name=keywords content="PVE,MacOS,Hackintosh,黑苹果"><title>PVE 虚拟化黑苹果显卡直通及远程访问教程</title><link rel=canonical href=https://blog.lv5.moe/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial><link rel=stylesheet href=/scss/style.min.css><script>function addLoadEvent(e){var t=window.onload;typeof window.onload!="function"?window.onload=e:window.onload=function(){t(),e()}}</script><meta property="og:title" content="PVE 虚拟化黑苹果显卡直通及远程访问教程"><meta property="og:description" content="PVE 虚拟化黑苹果显卡直通教程（核显&amp;amp;独显通用），低延迟远程访问方案：VNC、ARD、ToDesk、ParSec、Jump Desktop 等远程桌面协议/软件测试横评
"><meta property="og:url" content="https://blog.lv5.moe/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial"><meta property="og:site_name" content="SSpiritsの秘密基地"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="PVE"><meta property="article:tag" content="MacOS"><meta property="article:tag" content="Hackintosh"><meta property="article:tag" content="黑苹果"><meta property="article:published_time" content="2022-04-13T17:14:00+08:00"><meta property="article:modified_time" content="2022-11-19T13:47:22+08:00"><meta property="og:image" content="https://blog.lv5.moe/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/hackintosh-logo.png"><meta name=twitter:title content="PVE 虚拟化黑苹果显卡直通及远程访问教程"><meta name=twitter:description content="PVE 虚拟化黑苹果显卡直通教程（核显&amp;amp;独显通用），低延迟远程访问方案：VNC、ARD、ToDesk、ParSec、Jump Desktop 等远程桌面协议/软件测试横评
"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.lv5.moe/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/hackintosh-logo.png"><link rel="shortcut icon" href=/favicon.ico><script async defer data-website-id=3f278efc-35a9-46c8-8359-dcc0e76f7af3 src=https://a.lv5.moe/1650128973.js data-cache=true data-domains=blog.lv5.moe></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QNTL14TJQR"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QNTL14TJQR",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex
<!--
extended
-->
on-phone--column extended"><div id=article-toolbar><a href=https://blog.lv5.moe class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/img/avatar_hu6d9469b8bfc8dfa514aef419be5b4fe8_57345_300x0_resize_q75_box.jpg width=300 height=299 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>🍥</span></figure><h1 class=site-name><a href=/>SSpiritsの秘密基地</a></h1><h2 class=site-description>わたし、気になります！</h2><ol class=social-menu><li><a href=mailto:admin@lv5.moe target=_blank title=Email><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=https://github.com/ShadowySpirits target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/index.xml><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>RSS</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/hackintosh-logo.png width=857 height=350 loading=eager alt="Featured image of post PVE 虚拟化黑苹果显卡直通及远程访问教程"></a></div><div class=article-details><header class=article-category><a href=/categories/share style=background-color:green;color:#fff>杂七杂八的分享</a></header><h2 class=article-title><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial>PVE 虚拟化黑苹果显卡直通及远程访问教程</a></h2><h3 class=article-subtitle><p>PVE 虚拟化黑苹果显卡直通教程（核显&独显通用），低延迟远程访问方案：VNC、ARD、ToDesk、ParSec、Jump Desktop 等远程桌面协议/软件测试横评</p></h3><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Apr 13, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>7 minute read</time></div><div id=visitor-count><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-book" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 19a9 9 0 019 0 9 9 0 019 0"/><path d="M3 6a9 9 0 019 0 9 9 0 019 0"/><line x1="3" y1="6" x2="3" y2="19"/><line x1="12" y1="6" x2="12" y2="19"/><line x1="21" y1="6" x2="21" y2="19"/></svg><span id=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial class=waline-visitor-count></span>&nbsp;visitors</div></footer></div></header><section class=article-content><p>PVE 虚拟化黑苹果显卡直通教程（核显&独显通用），低延迟远程访问方案：VNC、ARD、ToDesk、ParSec、Jump Desktop 等远程桌面协议/软件测试横评</p><h2 id=适用场景>适用场景</h2><p>博主曾经用笔记本装黑苹果做过一段时间的主力机，但是因为有使用 Windows 的强需求，双系统切换不方便所以最终换回的 Windows。当时就在想如果有一台服务器跑着 MacOS，随时可以从主力机 Windows 远程访问岂不是两全其美。但是近年矿潮显卡价格虚高，实在是没有入手的欲望，最近趁矿难显卡价格下跌入手一块 AMD RX460 实践一下这个想法</p><p>阅读本文需要的前置步骤：</p><ol><li>一台运行 PVE 的主机</li><li>在 PVE 上成功安装黑苹果（使用 ）</li><li>至少进入黑苹果一次开启 <code>设置->共享->屏幕共享</code>（显卡直通可能会导致 PVE 自带的 VNC 卡在白苹果界面）</li></ol><p>黑苹果能否成功运行和硬件以及驱动有很大的关系，而使用 PVE 使用的 KVM 虚拟化技术可以最大程度上屏蔽硬件的差异提高成功率，借助 <a class=link href=https://github.com/thenickdude/KVM-Opencore target=_blank rel=noopener>KVM-Opencore</a> 项目提供的驱动可以做到开箱即用，不用折腾</p><p>PVE 和黑苹果安装教程这里推荐两篇博客，写的非常详细</p><ul><li><a class=link href=https://www.nicksherlock.com/2021/10/installing-macos-12-monterey-on-proxmox-7 target=_blank rel=noopener>Installing macOS 12 “Monterey” on Proxmox 7</a></li><li><a class=link href=https://www.sqlsec.com/2022/04/pve.html target=_blank rel=noopener>国光的 PVE 生产环境配置优化记录</a></li></ul><p></p><div class="tip inlineBlock warning">对于国光这篇文章有一处勘误，文章中说到 PVE 7.1 不能显卡直通，实际上我测试是可以的，读者可以在下文中找到我使用的软件版本</div><p></p><h2 id=主要配置>主要配置</h2><h3 id=硬件配置>硬件配置</h3><p>CPU: i5 10400<br>GPU: UHD630、AMD RX460</p><p>其他硬件均虚拟化</p><h3 id=软件版本>软件版本</h3><p>虚拟化平台：PVE</p><p>主要软件包版本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>~ pveversion -v
</span></span><span class=line><span class=cl>proxmox-ve: 7.1-1 <span class=o>(</span>running kernel: 5.13.19-6-pve<span class=o>)</span>
</span></span><span class=line><span class=cl>pve-manager: 7.1-12 <span class=o>(</span>running version: 7.1-12/b3c09de3<span class=o>)</span>
</span></span><span class=line><span class=cl>pve-kernel-helper: 7.1-14
</span></span><span class=line><span class=cl>pve-kernel-5.13: 7.1-9
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>MacOS 版本：macOS Monterey 12.3.1(21E258)（使用 <a class=link href=https://github.com/thenickdude/OSX-KVM target=_blank rel=noopener>OSX-KVM</a> 项目制作镜像）<br>OpenCore&EFI 版本：<a class=link href=https://github.com/thenickdude/KVM-Opencore/releases/tag/v16 target=_blank rel=noopener>KVM-Opencore v16</a></p><h2 id=显卡直通>显卡直通</h2><p>因为我是通过远程访问使用黑苹果，所以并没有把要直通的 GPU 设置为主 GPU，这是本文和其他直通教程的主要区别。这样做的好处是可以用 PVE 的后台直接查看黑苹果启动情况、进入 Recovery 模式等</p><p>参考 <a class=link href=https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29 target=_blank rel=noopener>Arch Linux wiki</a></p><h3 id=启用-iommu>启用 IOMMU</h3><p>这里引用 Arch Linux wiki 中对 IOMMU 的介绍：</p><blockquote><p>IOMMU 是 Intel VT-d 和 AMD-Vi 的通用名称。<br>VT-d 指的是直接输入/输出虚拟化(Intel Virtualization Technology for Directed I/O)，不应与 VT-x(x86 平台下的 Intel 虚拟化技术，Intel Virtualization Technology)混淆。VT-x 可以让一个硬件平台作为多个“虚拟”平台，而 VT-d 提高了虚拟化的安全性、可靠性和 I/O 性能。</p></blockquote><p>首先在 BIOS 中开启 VT-d</p><p>然后修改内核参数开启 IOMMU：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>- GRUB_CMDLINE_LINUX_DEFAULT=&#34;quiet&#34;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+ GRUB_CMDLINE_LINUX_DEFAULT=&#34;quiet intel_iommu=on iommu=pt pcie_acs_override=downstream video=efifb:off&#34;
</span></span></span></code></pre></div><p>这里解释下这几个参数的作用：</p><ul><li>intel_iommu=on：开启 IOMMU，对于 AMD CPU 需要使用 amd_iommu=on</li><li>iommu=pt：pt 是 passthrough 的缩写，可以提高性能</li><li>pcie_acs_override=downstream: 可以将同一 Group 中的设备分开直通</li><li>video=efifb:off：禁用 efifb 驱动，防止出现报错 BAR 3: cannot reserve [mem]</li></ul><p>更新内核参数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>update-grub
</span></span></code></pre></div><p>重启后可以用以下脚本测试</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;</span><span class=k>$(</span>curl -fsSL https://gist.githubusercontent.com/ShadowySpirits/018ea8675100baf768afff0d835e7862/raw/8e1c12f5766f0d308628ad1373b2f8603c523480/check_iommu.sh<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>如果你遇到网络问题可以直接复制并执行以下脚本内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bas data-lang=bas><span class=line><span class=cl><span class=err>#</span><span class=o>!/</span><span class=vg>bin</span><span class=o>/</span><span class=vg>bash</span>
</span></span><span class=line><span class=cl><span class=vg>shopt</span><span class=w> </span><span class=o>-</span><span class=vg>s</span><span class=w> </span><span class=vg>nullglob</span>
</span></span><span class=line><span class=cl><span class=vg>for</span><span class=w> </span><span class=vg>g</span><span class=w> </span><span class=vg>in</span><span class=w> </span><span class=err>$</span><span class=p>(</span><span class=vg>find</span><span class=w> </span><span class=o>/</span><span class=vg>sys</span><span class=o>/</span><span class=vg>kernel</span><span class=o>/</span><span class=vg>iommu_groups</span><span class=o>/*</span><span class=w> </span><span class=o>-</span><span class=vg>maxdepth</span><span class=w> </span><span class=il>0</span><span class=w> </span><span class=o>-</span><span class=vg>type</span><span class=w> </span><span class=vg>d</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=vg>sort</span><span class=w> </span><span class=o>-</span><span class=vg>V</span><span class=p>);</span><span class=w> </span><span class=vg>do</span>
</span></span><span class=line><span class=cl><span class=w>    </span><span class=vg>echo</span><span class=w> </span><span class=s2>&#34;IOMMU Group ${g##*/}:&#34;</span>
</span></span><span class=line><span class=cl><span class=w>    </span><span class=vg>for</span><span class=w> </span><span class=vg>d</span><span class=w> </span><span class=vg>in</span><span class=w> </span><span class=err>$</span><span class=vg>g</span><span class=o>/</span><span class=vg>devices</span><span class=o>/*</span><span class=p>;</span><span class=w> </span><span class=vg>do</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>echo</span><span class=w> </span><span class=o>-</span><span class=vg>e</span><span class=w> </span><span class=s2>&#34;\t$(lspci -nns ${d##*/})&#34;</span>
</span></span><span class=line><span class=cl><span class=w>    </span><span class=vg>done</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=vg>done</span><span class=p>;</span>
</span></span></code></pre></div><p>看到类似以下信息说明 IOMMU 开启成功</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>IOMMU Group 0:
</span></span><span class=line><span class=cl>        00:00.0 Host bridge [0600]: Intel Corporation Comet Lake-S 6c Host Bridge/DRAM Controller [8086:9b53] (rev 05)
</span></span><span class=line><span class=cl>IOMMU Group 1:
</span></span><span class=line><span class=cl>        00:01.0 PCI bridge [0604]: Intel Corporation 6th-10th Gen Core Processor PCIe Controller (x16) [8086:1901] (rev 05)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>IOMMU Group 6:
</span></span><span class=line><span class=cl>        00:1c.0 PCI bridge [0604]: Intel Corporation Device [8086:a394] (rev f0)
</span></span><span class=line><span class=cl>        03:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 460/560D / Pro 450/455/460/555/555X/560/560X] [1002:67ef] (rev cf)
</span></span><span class=line><span class=cl>        03:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X] [1002:aae0]
</span></span></code></pre></div><p></p><div class="tip inlineBlock warning">如果上面没有开启 <code>pcie_acs_override=downstream</code> 就只能将整个 Group 下的设备都直通给某个虚拟机</div><p></p><h3 id=隔离-gpu>隔离 GPU</h3><p>我们需要使用占位驱动程序（vfio）接管显卡，这样才能后续将显卡分配给虚拟机</p><p>在 PVE 宿主机的 /etc/modules 中添加 vfio 模块</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>vfio
</span></span><span class=line><span class=cl>vfio_iommu_type1
</span></span><span class=line><span class=cl>vfio_pci
</span></span><span class=line><span class=cl>vfio_virqfd
</span></span></code></pre></div><p>修改 /etc/modprobe.d/vfio.conf 将显卡的供应商-设备 ID 传递给 vfio 驱动，供应商-设备 ID 可以在上面脚本的输出的 <code>[]</code> 中找到，多个设备用 <code>,</code> 分隔</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>options vfio-pci ids=device_id1,device_id2 disable_vga=1
</span></span></code></pre></div><p>以我的 RX460 为例，它的供应商-设备 ID 是 1002:67ef 和 1002:aae0</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>IOMMU Group 6:
</span></span><span class=line><span class=cl>        00:1c.0 PCI bridge [0604]: Intel Corporation Device [8086:a394] (rev f0)
</span></span><span class=line><span class=cl>        03:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 460/560D / Pro 450/455/460/555/555X/560/560X] [1002:67ef] (rev cf)
</span></span><span class=line><span class=cl>        03:00.1 Audio device [0403]: Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X] [1002:aae0]
</span></span></code></pre></div><p>所以需要添加的内容是：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>options vfio-pci ids=1002:67ef,1002:aae0 disable_vga=1
</span></span></code></pre></div><p>然后在 PVE 宿主机的 /etc/modprobe.d/blacklist.conf 中禁用其他显卡驱动，防止这些驱动在 vfio 前加载</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># NVIDIA
</span></span><span class=line><span class=cl>blacklist nvidiafb
</span></span><span class=line><span class=cl>blacklist nouveau
</span></span><span class=line><span class=cl>blacklist nvidia
</span></span><span class=line><span class=cl>blacklist snd_hda_intel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Intel
</span></span><span class=line><span class=cl>blacklist snd_hda_codec_hdmi
</span></span><span class=line><span class=cl>blacklist i915
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># AMD
</span></span><span class=line><span class=cl>blacklist radeon
</span></span></code></pre></div><p>最后应用更改并重启</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>update-initramfs -u
</span></span></code></pre></div><h3 id=分配显卡>分配显卡</h3><p>重启后就可以将显卡分配给虚拟机了：</p><p>在设备中选择添加 PCI 设备，然后选择你要添加的显卡即可（独显核显都可以）</p><p><figure class=gallery-image style=flex-grow:238;flex-basis:572px><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/pve-passthrough.jpeg data-size=599x251><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/pve-passthrough.jpeg width=599 height=251 loading=lazy alt="pve 直通选项"></a><figcaption>pve 直通选项</figcaption></figure></p><p></p><div class="tip inlineBlock info">不同的显卡这里选择的选项不太一样，根据我的试验：<br>直通 UHD630 只需要勾选 <code>全功能（All Functions）</code><br>直通 AMD RX460 除了 <code>主 GPU（Primary GPU）</code> 外的选项都需要勾选</div><p></p><p>直通之后 PVE 自带的 VNC 可能会卡在白苹果界面，其实系统已经正常启动，可以使用 MacOS 自带的 VNC 进行连接</p><p><figure class=gallery-image style=flex-grow:141;flex-basis:339px><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/stuck-apple.png data-size=670x474><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/stuck-apple.png width=670 height=474 loading=lazy alt=白苹果></a><figcaption>白苹果</figcaption></figure></p><h2 id=远程访问>远程访问</h2><h3 id=分辨率调整>分辨率调整</h3><p>当你通过 PVE 自带的 VNC 连接黑苹果的时候会发现有一个分辨率为 1080p 的内置显示器，并且没有其他分辨率的选项，所以需要一些奇技淫巧来强制修改分辨率：</p><p>这里用到两个软件：BetterDummy 和 SwitchResX</p><p>首先使用 BetterDummy 创建一个和你物理显示器比例一致的虚拟显示器并设为主显示器</p><p><figure class=gallery-image style=flex-grow:114;flex-basis:275px><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/create-new-dummy.jpeg data-size=525x458><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/create-new-dummy.jpeg width=525 height=458 loading=lazy alt=创建虚拟显示器></a><figcaption>创建虚拟显示器</figcaption></figure></p><p>然后使用 SwitchResX 修改虚拟显示器分辨率为你物理显示器的原生分辨率</p><p><figure class=gallery-image style=flex-grow:209;flex-basis:502px><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/switch-res.jpeg data-size=538x257><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/switch-res.jpeg width=538 height=257 loading=lazy alt=修改分辨率></a><figcaption>修改分辨率</figcaption></figure></p><p></p><div class="tip inlineBlock info">不推荐使用带有 HiDPI 的分辨率，因为 HiDPI 是一种超采样技术（HiDPI 原理可以参考<a class=link href=https://blog.skk.moe/post/hidpi-what-why-how/ target=_blank rel=noopener>这篇文章</a>）靠渲染更多的像素来使图像“看起来”更清晰。但是大部分远程桌面软件都会将原生分辨率压缩为当前物理屏幕分辨率进行传输，所以开启 HiDPI 除了会浪费计算资源、增加延迟外没有任何意义</div><p></p><p>（可选）使用 SwitchResX 关闭默认显示器<br>这个步骤不是必须的，如果你的远程桌面软件无法选择用于串流的显示器（比如 VNC Viewer）可以关闭默认显示器来强制软件使用虚拟显示器</p><p><figure class=gallery-image style=flex-grow:174;flex-basis:418px><a href=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/disable-default-display.jpeg data-size=469x269><img src=/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial/disable-default-display.jpeg width=469 height=269 loading=lazy alt=关闭默认显示器></a><figcaption>关闭默认显示器</figcaption></figure></p><h3 id=原生方案>原生方案</h3><p>MacOS 原生提供 VNC 和 ARD 两种协议进行远程访问，可以在 <code>设置->分享</code> 中开启</p><h4 id=vnc>VNC</h4><p>自带的 VNC 是阉割版的，体验上做的很差：不支持调整画质、分辨率，不支持选择显示器（多显示器会横向拼接显示内容）从 Windows 访问键位映射有问题并且无法修改，卡顿严重，拖动窗口的时候尤其明显。唯一的优点是画质非常好，是本文介绍的所有方案中唯一一个使用原生分辨率传输（开启 HiDPI 画质明显提升）</p><h4 id=ard>ARD</h4><p>ARD 属于是 VNC 套壳，可以使用 Apple 官方的 <a class=link href="https://apps.apple.com/us/app/apple-remote-desktop/id409907375?mt=12" target=_blank rel=noopener>Apple Remote Desktop</a> 软件（售价高达 518，不会真有冤大头会买吧。。。）连接黑苹果主机。相比于 VNC，ARD 支持选择显示器，提供 4 挡可调的图像质量，在保证画质的前提下提供不错的延迟表现。并且除了远程桌面以外还提供命令执行、系统报告、文件传输等系统管理功能，缺点是只支持 MacOS（Windows 下可以使用支持 VNC 协议的软件连接，但是会退化成和原生 VNC 一样的垃圾体验）</p><h4 id=自建-vnc-server>自建 VNC Server</h4><p>既然自带的 VNC 如此不堪使用，ARD 又不提供 Windows 客户端，我们只能求助于第三方软件来提供满血版 VNC 协议支持。这里推荐 <a class=link href=https://www.realvnc.com/en/connect/download/vnc/macos/ target=_blank rel=noopener>Real VNC</a>，可以兼具 VNC 高画质和 ARD 的低延迟，除了不支持 HiDPI 外基本上能提供和连接显示器一致的体验</p><h3 id=第三方软件私有协议>第三方软件/私有协议</h3><h4 id=todesk>ToDesk</h4><p>ToDesk 在我的体验中卡顿非常严重。除了提供免费的内网穿透以外，相比其他方案基本上毫无优势可言，如果你有公网 IP 的话不要选择它。所以名气大的（尤其是国产软件）不一定真的好用。。。</p><h4 id=parsec>ParSec</h4><p>ParSec 的原本用途是游戏串流，提供精细的配置项可供选择，细节上体验很舒适。相比于其他方案它的延迟和画面质量很稳定，不会在画面快速变化时卡顿或者糊掉，并且支持播放被控主机声音。可能是现在 Mac 版还处于 Beta 阶段的原因，ParSec 对性能要求很高，RX460 在 2560×1440 分辨率下延迟 20ms 左右，3440×1440（2k 带鱼屏）分辨率下延迟 40ms 左右</p><h4 id=jump-desktop>Jump Desktop</h4><p>Jump Desktop 是老牌 mac 远程桌面应用，使用私有的 Fluid 协议。延迟低、带宽占用低，但是画面也是最糊的，特别是窗口拖动等画面快速变化的场景涂抹感非常严重。Jump Desktop 支持自定义任何按键或是组合键的映射，和 ParSec 一样也支持播放被控主机声音</p><h2 id=总结与性能测试>总结与性能测试</h2><p>测试环境：</p><p>GPU： 直通 RX460 GeekBench 5 Metal 分 21000 左右，性能大致相当于 M1 核显<br>网络：内网（网络延迟 &lt;1ms）<br>分辨率：3440x1440（非 HiDPI）<br>软件版本：各软件均使用当前最新免费/试用版，画质选择最高一档</p><table><thead><tr><th>软件/协议</th><th>延迟</th><th>画质</th><th>按键映射</th><th>多显示器</th><th>声音</th><th>文件传输</th><th>连接方式</th></tr></thead><tbody><tr><td>原生 VNC</td><td>高</td><td>最好（支持 HiDPI）</td><td>不支持修改</td><td>拼接所有显示器</td><td>不支持</td><td>不支持</td><td>直连</td></tr><tr><td>RealVNC</td><td>低（2ms）</td><td>最好</td><td>自定义任何按键映射</td><td>服务端配置</td><td>不支持</td><td>支持</td><td>直连</td></tr><tr><td>ARD</td><td>中等</td><td>一般（滚动时画面会糊）</td><td>不支持修改</td><td>客户端选择</td><td>不支持</td><td>支持</td><td>直连</td></tr><tr><td>ToDesk</td><td>高</td><td>一般（有明显涂抹感）</td><td>自定义功能键映射</td><td>客户端选择</td><td>不支持</td><td>支持</td><td>免费内网穿透</td></tr><tr><td>ParSec</td><td>中等（40ms）</td><td>较好（有轻微涂抹感）</td><td>不支持修改</td><td>客户端选择</td><td>支持</td><td>不支持</td><td>直连（自动 UPNP）</td></tr><tr><td>Jump Desktop</td><td>低（10ms）</td><td>差（画面最糊）</td><td>自定义任何按键映射</td><td>客户端选择</td><td>支持</td><td>不支持</td><td>直连（自动 UPNP）</td></tr></tbody></table><p></p><div class="tip inlineBlock info">除 ToDesk 外的方案若想要通过公网访问均需要被控端具备公网 IP 并配置端口映射或自行搭建内网穿透<br>ParSec 和 Jump Desktop 会通过 UPNP 帮你自动映射端口，并且登陆它们的账号可以直接看到你的被控端主机，不用通过 IP 手动添加主机，尤其适用于你的公网 IP 是动态 IP 的情况</div><p></p></section><footer class=article-footer><section class=article-tags><a href=/tags/pve>PVE</a>
<a href=/tags/macos>MacOS</a>
<a href=/tags/hackintosh>Hackintosh</a>
<a href=/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C>黑苹果</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under <a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0 target=_blank rel=noopener>CC BY-NC-SA 4.0</a></br>转载或引用本文时请遵守许可协议，知会作者并注明出处</br>不得用于商业用途！</span></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>Last updated on Nov 19, 2022 13:47</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article class=has-image><a href=/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges><div class=article-image><img src=/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges/dns.35e2285a25bd29bfb5085f30697638a7_hu68696ece74dcc060ca3f65dbe2b1cee1_41184_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key=use-dns-to-create-split-routing-for-different-domain-or-ip-ranges data-hash="md5-NeIoWiW9Kb+1CF8waXY4pw=="></div><div class=article-details><h2 class=article-title>巧用 DNS 实现国内外域名 ip 分流上网</h2></div></a></article><article class=has-image><a href=/p/website-hosting-and-function-computing-service-selection><div class=article-image><img src=/p/website-hosting-and-function-computing-service-selection/cover.svg loading=lazy data-key=website-hosting-and-function-computing-service-selection data-hash=/p/website-hosting-and-function-computing-service-selection/cover.svg></div><div class=article-details><h2 class=article-title>Cloudflare or Vercel —— 网站托管与函数计算服务选择</h2></div></a></article><article class=has-image><a href=/p/selection-and-migration-from-typecho-to-hugo><div class=article-image><img src=/img/71360830_p0.409931285b4d88ac5bc04313c8711b27_hu465e5a0e70aa4f411dc46346df3ca0ca_139182_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=selection-and-migration-from-typecho-to-hugo data-hash="md5-QJkxKFtNiKxbwEMTyHEbJw=="></div><div class=article-details><h2 class=article-title>从 Typecho 到 Hugo 的选择与迁移</h2></div></a></article><article class=has-image><a href=/p/nginx-ssl-tls-configuration-optimization><div class=article-image><img src=/p/nginx-ssl-tls-configuration-optimization/ssl-logo.dcc1d89a79f4e18c05f875ef1d4c47e7_hu0d352a211a34cc70a94a1106767ca9fd_19549_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=nginx-ssl-tls-configuration-optimization data-hash="md5-3MHYmnn04YwF+HXvHUxH5w=="></div><div class=article-details><h2 class=article-title>Nginx SSL/TLS 配置优化</h2></div></a></article><article class=has-image><a href=/p/deluge-modify-user-agent-and-peer-id-tutorials><div class=article-image><img src=/p/deluge-modify-user-agent-and-peer-id-tutorials/deluge-logo.da65f5c515641d892af10ab163731505_hud927fadcfecc8c2fd76c8e1fda8fa111_26133_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=deluge-modify-user-agent-and-peer-id-tutorials data-hash="md5-2mX1xRVkHYkq8QqxY3MVBQ=="></div><div class=article-details><h2 class=article-title>Deluge 2.0.3 修改 user-agent 和 peer-id 教程</h2></div></a></article></div></div></aside><script async defer src=//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js></script><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}.waline-container .vcount{color:var(--card-text-color-main)}:root{--waline-theme-color:#0e6db1;--waline-active-color:#107fcf}</style><script>addLoadEvent(function(){new Waline({el:"#waline",dark:'html[data-scheme="dark"]',serverURL:"https://comment.lv5.moe",visitor:!0,copyright:!1,avatar:"retro",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji"],requiredMeta:["nick","mail"]})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 SSpiritsの秘密基地</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/ShadowySpirits/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> modified by <a href=https://blog.lv5.moe target=_blank rel=noopener>SSpirits</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><div id=article-toolbar><a href=https://blog.lv5.moe class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a>
<a href=/about class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></div><form action=/search class="search-form widget"><p><label>Search</label>
<input name=keyword required placeholder="Type something...">
<button title=Search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button></p></form><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#适用场景>适用场景</a></li><li><a href=#主要配置>主要配置</a><ol><li><a href=#硬件配置>硬件配置</a></li><li><a href=#软件版本>软件版本</a></li></ol></li><li><a href=#显卡直通>显卡直通</a><ol><li><a href=#启用-iommu>启用 IOMMU</a></li><li><a href=#隔离-gpu>隔离 GPU</a></li><li><a href=#分配显卡>分配显卡</a></li></ol></li><li><a href=#远程访问>远程访问</a><ol><li><a href=#分辨率调整>分辨率调整</a></li><li><a href=#原生方案>原生方案</a><ol><li><a href=#vnc>VNC</a></li><li><a href=#ard>ARD</a></li><li><a href=#自建-vnc-server>自建 VNC Server</a></li></ol></li><li><a href=#第三方软件私有协议>第三方软件/私有协议</a><ol><li><a href=#todesk>ToDesk</a></li><li><a href=#parsec>ParSec</a></li><li><a href=#jump-desktop>Jump Desktop</a></li></ol></li></ol></li><li><a href=#总结与性能测试>总结与性能测试</a></li></ol></nav></div></section><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg></div><h2 class="widget-title section-title">Archives</h2><div class=widget-archive--list><div class=archives-year><a href=/archives#2023><span class=year>2023</span>
<span class=count>2</span></a></div><div class=archives-year><a href=/archives#2022><span class=year>2022</span>
<span class=count>8</span></a></div><div class=archives-year><a href=/archives#2021><span class=year>2021</span>
<span class=count>5</span></a></div><div class=archives-year><a href=/archives#2019><span class=year>2019</span>
<span class=count>17</span></a></div><div class=archives-year><a href=/archives#2018><span class=year>2018</span>
<span class=count>6</span></a></div></div></section><section class="widget tagCloud"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg></div><h2 class="widget-title section-title">Tags</h2><div class=tagCloud-tags><a href=/tags/linux class=font_size_4>Linux</a>
<a href=/tags/rocketmq class=font_size_4>RocketMQ</a>
<a href=/tags/typecho class=font_size_4>Typecho</a>
<a href=/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6 class=font_size_4>中间件</a>
<a href=/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97 class=font_size_4>消息队列</a>
<a href=/tags/cdn class=font_size_3>CDN</a>
<a href=/tags/java class=font_size_3>Java</a>
<a href=/tags/kotlin class=font_size_3>Kotlin</a>
<a href=/tags/operating-system class=font_size_3>Operating System</a>
<a href=/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7 class=font_size_3>可观测性</a>
<a href=/tags/android class=font_size_2>Android</a>
<a href=/tags/bt/pt class=font_size_2>BT/PT</a>
<a href=/tags/cloudflare class=font_size_2>Cloudflare</a>
<a href=/tags/db class=font_size_2>DB</a>
<a href=/tags/kubernetes class=font_size_2>Kubernetes</a>
<a href=/tags/laravel class=font_size_2>Laravel</a>
<a href=/tags/math class=font_size_2>Math</a>
<a href=/tags/nginx class=font_size_2>Nginx</a>
<a href=/tags/php class=font_size_2>PHP</a>
<a href=/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86 class=font_size_2>内存管理</a>
<a href=/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90 class=font_size_2>源码分析</a>
<a href=/tags/alibaba-cloud class=font_size_1>Alibaba Cloud</a>
<a href=/tags/clash class=font_size_1>Clash</a>
<a href=/tags/codec class=font_size_1>Codec</a>
<a href=/tags/concurrent class=font_size_1>Concurrent</a>
<a href=/tags/crack class=font_size_1>Crack</a>
<a href=/tags/dns class=font_size_1>DNS</a>
<a href=/tags/file-system class=font_size_1>File System</a>
<a href=/tags/font class=font_size_1>font</a>
<a href=/tags/hackintosh class=font_size_1>Hackintosh</a>
<a href=/tags/homelab class=font_size_1>HomeLab</a>
<a href=/tags/hugo class=font_size_1>Hugo</a>
<a href=/tags/iptables class=font_size_1>iptables</a>
<a href=/tags/jvm class=font_size_1>JVM</a>
<a href=/tags/k3s class=font_size_1>K3s</a>
<a href=/tags/kms class=font_size_1>KMS</a>
<a href=/tags/macos class=font_size_1>MacOS</a>
<a href=/tags/media class=font_size_1>Media</a>
<a href=/tags/metrics class=font_size_1>Metrics</a>
<a href=/tags/mosdns class=font_size_1>MosDNS</a>
<a href=/tags/mysql class=font_size_1>Mysql</a>
<a href=/tags/nas class=font_size_1>NAS</a>
<a href=/tags/nextcloud class=font_size_1>Nextcloud</a>
<a href=/tags/oss class=font_size_1>OSS</a>
<a href=/tags/pbr class=font_size_1>PBR</a>
<a href=/tags/pve class=font_size_1>PVE</a>
<a href=/tags/rancher class=font_size_1>Rancher</a>
<a href=/tags/serverless class=font_size_1>Serverless</a>
<a href=/tags/spring class=font_size_1>Spring</a>
<a href=/tags/ssl class=font_size_1>SSL</a>
<a href=/tags/traefik class=font_size_1>Traefik</a>
<a href=/tags/vercel class=font_size_1>Vercel</a>
<a href=/tags/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB class=font_size_1>博客迁移</a>
<a href=/tags/%E5%8F%88%E6%8B%8D%E4%BA%91 class=font_size_1>又拍云</a>
<a href=/tags/%E5%9D%97%E5%AD%98%E5%82%A8 class=font_size_1>块存储</a>
<a href=/tags/%E5%AD%98%E5%82%A8 class=font_size_1>存储</a>
<a href=/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8 class=font_size_1>对象存储</a>
<a href=/tags/%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1 class=font_size_1>策略路由</a>
<a href=/tags/%E9%98%BF%E9%87%8C%E4%BA%91 class=font_size_1>阿里云</a>
<a href=/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C class=font_size_1>黑苹果</a></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script type=text/javascript>console.log("%c SSpiritsの秘密基地 %c わたし、気になります！ ","color: #fff; margin: 1em 0; padding: 5px 0; background: #3498db;","margin: 1em 0; padding: 5px 0; background: #efefef;")</script></body><script>if(!window.location.pathname.startsWith("/p/"))for(var x=document.getElementById("visitor-count");x!=null;)x.remove(),x=document.getElementById("visitor-count")</script></html>
